package utils;

import java.io.File;
import java.io.IOException;
import java.nio.file.Files;
import java.nio.file.Paths;
import java.util.Map;
import java.util.HashMap;

import com.fasterxml.jackson.databind.ObjectMapper;

public class Helper {

    private static final ObjectMapper mapper = new ObjectMapper();

    /**
     * Load configuration from JSON file
     */
    public static Map<String, Object> loadConfig() {
        try {
            // tương đương: os.path.join(os.path.dirname(__file__), "..", "config", "config.json")
            String basePath = new File(Helper.class.getProtectionDomain()
                    .getCodeSource().getLocation().getPath())
                    .getParentFile()
                    .getParent();

            String configPath = Paths.get(basePath, "config", "config.json").toString();

            byte[] jsonData = Files.readAllBytes(Paths.get(configPath));
            return mapper.readValue(jsonData, Map.class);

        } catch (IOException e) {
            Map<String, Object> fallback = new HashMap<>();
            fallback.put("default", "config1111111");
            return fallback;
        }
    }

    /**
     * Process input data
     */
    public static String processData(Map<String, Object> data) {
        if (data != null) {
            return "Processed " + data.size() + " items";
        }
        return "No data to process";
    }

    /**
     * Format output text
     */
    public static String formatOutput(String text) {
        return text == null ? null : text.toUpperCase();
    }
}
